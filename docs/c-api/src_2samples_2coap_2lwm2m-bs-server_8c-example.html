<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Soletta™ Framework: /src/samples/coap/lwm2m-bs-server.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Soletta™ Framework
   </div>
   <div id="projectbrief">
   Framework for making IoT devices<br /><br />
   <small>
   <a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
   <a href="index.html">C API Index</a>
   </small><br />
   </div>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/src/samples/coap/lwm2m-bs-server.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This file is part of the Soletta (TM) Project</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2015 Intel Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment"> * you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment"> * You may obtain a copy of the License at</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment"> * See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment"> * limitations under the License.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">   To run: ./lwm2m-sample-bs-server [-p PORT] [-s SEC_MODE]</span></div>
<div class="line"><span class="comment">   For every LWM2M client that connects with the bootstrap server, the bootstrap</span></div>
<div class="line"><span class="comment">   server will send bootstrap information in order for that client to connect</span></div>
<div class="line"><span class="comment">   with the lwm2m-sample-server (through DTLS).</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sol-lwm2m-bs-server_8h.html">sol-lwm2m-bs-server.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sol-mainloop_8h.html">sol-mainloop.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sol-vector_8h.html">sol-vector.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sol-util_8h.html">sol-util.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define LIFETIME (60)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define SERVER_OBJ_ID (1)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SERVER_OBJ_SHORT_RES_ID (0)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SERVER_OBJ_LIFETIME_RES_ID (1)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SERVER_OBJ_BINDING_RES_ID (7)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SERVER_OBJ_REGISTRATION_UPDATE_RES_ID (8)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define ACCESS_CONTROL_OBJ_ID (2)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ACCESS_CONTROL_OBJ_OBJECT_RES_ID (0)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ACCESS_CONTROL_OBJ_INSTANCE_RES_ID (1)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ACCESS_CONTROL_OBJ_ACL_RES_ID (2)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define ACCESS_CONTROL_OBJ_OWNER_RES_ID (3)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define SECURITY_OBJ_ID (0)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_SERVER_URI_RES_ID (0)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_IS_BOOTSTRAP_RES_ID (1)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_SECURITY_MODE_RES_ID (2)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_PUBLIC_KEY_OR_IDENTITY_RES_ID (3)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_SERVER_PUBLIC_KEY_RES_ID (4)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_SECRET_KEY_RES_ID (5)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_SERVER_ID_RES_ID (10)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_CLIENT_HOLD_OFF_TIME_RES_ID (11)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define SECURITY_BOOTSTRAP_SERVER_ACCOUNT_TIMEOUT_RES_ID (12)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define PSK_KEY_LEN 16</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define RPK_PRIVATE_KEY_LEN 32</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define RPK_PUBLIC_KEY_LEN (2 * RPK_PRIVATE_KEY_LEN)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">//FIXME: UNSEC: Hardcoded Crypto Keys</span></div>
<div class="line"><span class="preprocessor">#define CLIENT_BS_PSK_ID (&quot;cli1-bs&quot;)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLIENT_BS_PSK_KEY (&quot;FEDCBA9876543210&quot;)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLIENT_SERVER_PSK_ID (&quot;cli1&quot;)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define CLIENT_SERVER_PSK_KEY (&quot;0123456789ABCDEF&quot;)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define CLIENT_PUBLIC_KEY (&quot;D055EE14084D6E0615599DB583913E4A3E4526A2704D61F27A4CCFBA9758EF9A&quot; \</span></div>
<div class="line"><span class="preprocessor">    &quot;B418B64AFE8030DA1DDCF4F42E2F2631D043B1FB03E22F4D17DE43F9F9ADEE70&quot;)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define BS_SERVER_PRIVATE_KEY (&quot;9b7dfec20e49fe2cacf23fb21d06a8dc496530c695ec24cdf6c002ce44afa5fb&quot;)</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define BS_SERVER_PUBLIC_KEY (&quot;cd4110e97bbd6e7e5a800028079d02915c70b915ea4596402098deea585eb7ad&quot; \</span></div>
<div class="line"><span class="preprocessor">    &quot;f3e080487327f70758b13bc0583f4293d13288a0164a8e324779aa4f7ada26c1&quot;)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *<a name="a0"></a><a class="code" href="lwm2m-bs-server_8c.html#a4f866fa0389efe4c44b93653d7d1a9d9">known_clients</a>[] = { <span class="stringliteral">&quot;cli1&quot;</span>, <span class="stringliteral">&quot;cli2&quot;</span>, NULL };</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structsol__blob.html">sol_blob</a> <a name="a2"></a><a class="code" href="lwm2m-bs-server_8c.html#a097e371db2c28ce5b0c1a940c9ee36ff">server_one_addr</a> = {</div>
<div class="line">    .<a name="a3"></a><a class="code" href="structsol__blob.html#a6fc0c3359ab445414c8d0c1530de21f7">type</a> = &amp;<a name="a4"></a><a class="code" href="group__Types.html#gaa0c9a222da15228c2eb4ebaf12f9ebf2">SOL_BLOB_TYPE_NO_FREE</a>,</div>
<div class="line">    .parent = NULL,</div>
<div class="line">    .mem = (<span class="keywordtype">void</span> *)<span class="stringliteral">&quot;coaps://localhost:5684&quot;</span>,</div>
<div class="line">    .<a name="a5"></a><a class="code" href="structsol__blob.html#aa708cb5e0186b24dc4eee1a4669577b7">size</a> = <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;coaps://localhost:5684&quot;</span>) - 1,</div>
<div class="line">    .refcnt = 1</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsol__blob.html">sol_blob</a> <a name="a6"></a><a class="code" href="lwm2m-bs-server_8c.html#a296eb344b53c800b6f0142d34549a8de">binding</a> = {</div>
<div class="line">    .<a class="code" href="structsol__blob.html#a6fc0c3359ab445414c8d0c1530de21f7">type</a> = &amp;<a class="code" href="group__Types.html#gaa0c9a222da15228c2eb4ebaf12f9ebf2">SOL_BLOB_TYPE_NO_FREE</a>,</div>
<div class="line">    .parent = NULL,</div>
<div class="line">    .mem = (<span class="keywordtype">void</span> *)<span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">    .<a class="code" href="structsol__blob.html#aa708cb5e0186b24dc4eee1a4669577b7">size</a> = <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;U&quot;</span>) - 1,</div>
<div class="line">    .refcnt = 1</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsol__blob.html">sol_blob</a> <a name="a7"></a><a class="code" href="lwm2m-bs-server_8c.html#aaeb0515929bab58f4724e4638df423c9">psk_id_0</a> = {</div>
<div class="line">    .<a class="code" href="structsol__blob.html#a6fc0c3359ab445414c8d0c1530de21f7">type</a> = &amp;<a class="code" href="group__Types.html#gaa0c9a222da15228c2eb4ebaf12f9ebf2">SOL_BLOB_TYPE_NO_FREE</a>,</div>
<div class="line">    .parent = NULL,</div>
<div class="line">    .mem = (<span class="keywordtype">void</span> *)<a name="a8"></a><a class="code" href="lwm2m-bs-server_8c.html#a75e085c2bc5f933937ff9b262588a54f">CLIENT_SERVER_PSK_ID</a>,</div>
<div class="line">    .<a class="code" href="structsol__blob.html#aa708cb5e0186b24dc4eee1a4669577b7">size</a> = <span class="keyword">sizeof</span>(<a class="code" href="lwm2m-bs-server_8c.html#a75e085c2bc5f933937ff9b262588a54f">CLIENT_SERVER_PSK_ID</a>) - 1,</div>
<div class="line">    .refcnt = 1</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsol__blob.html">sol_blob</a> <a name="a9"></a><a class="code" href="lwm2m-bs-server_8c.html#a9393ccd69b5fbc5f51a694981479ceba">psk_key_0</a> = {</div>
<div class="line">    .<a class="code" href="structsol__blob.html#a6fc0c3359ab445414c8d0c1530de21f7">type</a> = &amp;<a class="code" href="group__Types.html#gaa0c9a222da15228c2eb4ebaf12f9ebf2">SOL_BLOB_TYPE_NO_FREE</a>,</div>
<div class="line">    .parent = NULL,</div>
<div class="line">    .mem = (<span class="keywordtype">void</span> *)<a name="a10"></a><a class="code" href="lwm2m-bs-server_8c.html#a600e67a87cc92351d1c3a8b0365a90aa">CLIENT_SERVER_PSK_KEY</a>,</div>
<div class="line">    .<a class="code" href="structsol__blob.html#aa708cb5e0186b24dc4eee1a4669577b7">size</a> = <span class="keyword">sizeof</span>(<a class="code" href="lwm2m-bs-server_8c.html#a600e67a87cc92351d1c3a8b0365a90aa">CLIENT_SERVER_PSK_KEY</a>) - 1,</div>
<div class="line">    .refcnt = 1</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a11"></a><a class="code" href="lwm2m-bs-server_8c.html#aab36980f01f7fae2838cc7929cacfc0f">write_resource_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *<a name="a12"></a><a class="code" href="server-https_8c.html#a3364dabb1b0bcb5ea73872456898225e">server</a>,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__CoAP.html#ga9d2598af666a528ba1f129c7d93bc804">sol_coap_response_code</a> response_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a name="a13"></a><a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (response_code != <a name="a14"></a><a class="code" href="group__CoAP.html#gga9d2598af666a528ba1f129c7d93bc804abe677b03fc638b5f4a5fc9bea1c93944">SOL_COAP_RESPONSE_CODE_CHANGED</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;The client %s could not write the object(s)/resource at %s.\n&quot;</span>,</div>
<div class="line">            name, path);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;The client %s wrote the object(s)/resource at %s.\n&quot;</span>, name, path);</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Sending Bootstrap Finish to %s!\n&quot;</span>, name);</div>
<div class="line">    r = <a name="a15"></a><a class="code" href="group__lwm2m__bs-server.html#ga06a807e86a357c3f30c46b469e66a387">sol_lwm2m_bootstrap_server_send_finish</a>(server, bs_cinfo);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0)</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Finish\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a16"></a><a class="code" href="lwm2m-bs-server_8c.html#ac758ab2ede2034abf4ff1560ba37fb04">write_servers_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *server,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__CoAP.html#ga9d2598af666a528ba1f129c7d93bc804">sol_coap_response_code</a> response_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a17"></a><a class="code" href="structsol__lwm2m__resource.html">sol_lwm2m_resource</a> server_two_lifetime;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (response_code != <a class="code" href="group__CoAP.html#gga9d2598af666a528ba1f129c7d93bc804abe677b03fc638b5f4a5fc9bea1c93944">SOL_COAP_RESPONSE_CODE_CHANGED</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;The client %s could not write the object(s)/resource at %s.\n&quot;</span>,</div>
<div class="line">            name, path);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;The client %s wrote the object(s)/resource at %s.\n&quot;</span>, name, path);</div>
<div class="line"></div>
<div class="line">    <a name="a18"></a><a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_two_lifetime, <a name="a19"></a><a class="code" href="lwm2m-bs-server_8c.html#ab250e6949031b04ab49d5478ac28b18e">SERVER_OBJ_LIFETIME_RES_ID</a>, <a name="a20"></a><a class="code" href="lwm2m-bs-server_8c.html#a59c40d5bd5fd4696c5790c748438bc47">LIFETIME</a> * 2);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Lifetime] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    r = <a name="a21"></a><a class="code" href="group__lwm2m__bs-server.html#ga459e5ddc708f8b1c7780f314cc31ef65">sol_lwm2m_bootstrap_server_write</a>(server, bs_cinfo, <span class="stringliteral">&quot;/1/0/1&quot;</span>,</div>
<div class="line">        &amp;server_two_lifetime, 1, <a class="code" href="lwm2m-bs-server_8c.html#aab36980f01f7fae2838cc7929cacfc0f">write_resource_cb</a>, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Write to /1/0/1\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a22"></a><a class="code" href="group__LWM2M.html#ga1d1f9bfd1cd20bad0958fae7a30b8ca3">sol_lwm2m_resource_clear</a>(&amp;server_two_lifetime);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a23"></a><a class="code" href="lwm2m-bs-server_8c.html#ae7eb8956cc2da1b6e4118d2e8e171f10">write_server_one_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *server,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__CoAP.html#ga9d2598af666a528ba1f129c7d93bc804">sol_coap_response_code</a> response_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line">    uint16_t i, j;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structsol__lwm2m__resource.html">sol_lwm2m_resource</a> server_two[3], server_three[3];</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structsol__lwm2m__resource.html">sol_lwm2m_resource</a> *servers[2] = {</div>
<div class="line">        server_two, server_three</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">size_t</span> servers_len[2] = {</div>
<div class="line">        <a name="a24"></a><a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(server_two), <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(server_three)</div>
<div class="line">    };</div>
<div class="line">    uint16_t servers_ids[2] = {</div>
<div class="line">        0, 4</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (response_code != <a class="code" href="group__CoAP.html#gga9d2598af666a528ba1f129c7d93bc804abe677b03fc638b5f4a5fc9bea1c93944">SOL_COAP_RESPONSE_CODE_CHANGED</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;The client %s could not write the object(s)/resource at %s.\n&quot;</span>,</div>
<div class="line">            name, path);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;The client %s wrote the object(s)/resource at %s.\n&quot;</span>, name, path);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Server Two&#39;s Server Object</span></div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_two[0], <a name="a25"></a><a class="code" href="lwm2m-bs-server_8c.html#a5f6e45091bc2c44bc60f16011c0ec1b0">SERVER_OBJ_SHORT_RES_ID</a>, 102);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Short Server ID] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_two[1], <a class="code" href="lwm2m-bs-server_8c.html#ab250e6949031b04ab49d5478ac28b18e">SERVER_OBJ_LIFETIME_RES_ID</a>, <a class="code" href="lwm2m-bs-server_8c.html#a59c40d5bd5fd4696c5790c748438bc47">LIFETIME</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Lifetime] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a name="a26"></a><a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;server_two[2], <a name="a27"></a><a class="code" href="lwm2m-bs-server_8c.html#a5bafd418567124d092e46265e389012d">SERVER_OBJ_BINDING_RES_ID</a>,</div>
<div class="line">        <a name="a28"></a><a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;binding);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Binding] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Server Three&#39;s Server Object</span></div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_three[0], <a class="code" href="lwm2m-bs-server_8c.html#a5f6e45091bc2c44bc60f16011c0ec1b0">SERVER_OBJ_SHORT_RES_ID</a>, 103);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Short Server ID] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_three[1], <a class="code" href="lwm2m-bs-server_8c.html#ab250e6949031b04ab49d5478ac28b18e">SERVER_OBJ_LIFETIME_RES_ID</a>, <a class="code" href="lwm2m-bs-server_8c.html#a59c40d5bd5fd4696c5790c748438bc47">LIFETIME</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Lifetime] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;server_three[2], <a class="code" href="lwm2m-bs-server_8c.html#a5bafd418567124d092e46265e389012d">SERVER_OBJ_BINDING_RES_ID</a>,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;binding);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Binding] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    r = <a name="a29"></a><a class="code" href="group__lwm2m__bs-server.html#ga10354511639f6f66abae28815e63a92c">sol_lwm2m_bootstrap_server_write_object</a>(server, bs_cinfo, <span class="stringliteral">&quot;/1&quot;</span>,</div>
<div class="line">        servers, servers_len, servers_ids, <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(servers), <a class="code" href="lwm2m-bs-server_8c.html#ac758ab2ede2034abf4ff1560ba37fb04">write_servers_cb</a>, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Write to /1\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(servers); i++)</div>
<div class="line">        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(server_two); j++)</div>
<div class="line">            <a class="code" href="group__LWM2M.html#ga1d1f9bfd1cd20bad0958fae7a30b8ca3">sol_lwm2m_resource_clear</a>(&amp;servers[i][j]);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a30"></a><a class="code" href="lwm2m-bs-server_8c.html#aa7de55e6a72b455f4ac4f0f841300fb9">write_sec_one_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *server,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__CoAP.html#ga9d2598af666a528ba1f129c7d93bc804">sol_coap_response_code</a> response_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line">    uint16_t i;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structsol__lwm2m__resource.html">sol_lwm2m_resource</a> server_one[3];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (response_code != <a class="code" href="group__CoAP.html#gga9d2598af666a528ba1f129c7d93bc804abe677b03fc638b5f4a5fc9bea1c93944">SOL_COAP_RESPONSE_CODE_CHANGED</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;The client %s could not write the object(s)/resource at %s.\n&quot;</span>,</div>
<div class="line">            name, path);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;The client %s wrote the object(s)/resource at %s.\n&quot;</span>, name, path);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Server One&#39;s Server Object</span></div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_one[0], <a class="code" href="lwm2m-bs-server_8c.html#a5f6e45091bc2c44bc60f16011c0ec1b0">SERVER_OBJ_SHORT_RES_ID</a>, 101);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Short Server ID] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;server_one[1], <a class="code" href="lwm2m-bs-server_8c.html#ab250e6949031b04ab49d5478ac28b18e">SERVER_OBJ_LIFETIME_RES_ID</a>, <a class="code" href="lwm2m-bs-server_8c.html#a59c40d5bd5fd4696c5790c748438bc47">LIFETIME</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Lifetime] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;server_one[2], <a class="code" href="lwm2m-bs-server_8c.html#a5bafd418567124d092e46265e389012d">SERVER_OBJ_BINDING_RES_ID</a>,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;binding);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Server Object&#39;s [Binding] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    r = <a class="code" href="group__lwm2m__bs-server.html#ga459e5ddc708f8b1c7780f314cc31ef65">sol_lwm2m_bootstrap_server_write</a>(server, bs_cinfo, <span class="stringliteral">&quot;/1/0&quot;</span>,</div>
<div class="line">        server_one, <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(server_one), <a class="code" href="lwm2m-bs-server_8c.html#ae7eb8956cc2da1b6e4118d2e8e171f10">write_server_one_cb</a>, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Write to /1/0\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(server_one); i++)</div>
<div class="line">        <a class="code" href="group__LWM2M.html#ga1d1f9bfd1cd20bad0958fae7a30b8ca3">sol_lwm2m_resource_clear</a>(&amp;server_one[i]);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a31"></a><a class="code" href="lwm2m-bs-server_8c.html#aef4e7c3aca43eeada6f65597335a068e">delete_all_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *server,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__CoAP.html#ga9d2598af666a528ba1f129c7d93bc804">sol_coap_response_code</a> response_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line">    uint16_t i;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structsol__lwm2m__resource.html">sol_lwm2m_resource</a> sec_server_one[6];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (response_code != <a name="a32"></a><a class="code" href="group__CoAP.html#gga9d2598af666a528ba1f129c7d93bc804abef90f9701bc2e1eb52f6827ec89dfc8">SOL_COAP_RESPONSE_CODE_DELETED</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;The client %s could not delete the object at %s.\n&quot;</span>,</div>
<div class="line">            name, path);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;The client %s deleted the object at %s.\n&quot;</span>, name, path);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Server One&#39;s Security Object</span></div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;sec_server_one[0], <a name="a33"></a><a class="code" href="lwm2m-bs-server_8c.html#a041a6bc91562dab435e3292f3aaacbfe">SECURITY_SERVER_URI_RES_ID</a>,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;server_one_addr);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Server URI] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;sec_server_one[1], <a name="a34"></a><a class="code" href="lwm2m-bs-server_8c.html#a76f5fa8806d00c7fda26e03951d6dadd">SECURITY_IS_BOOTSTRAP_RES_ID</a>,</div>
<div class="line">        <a name="a35"></a><a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48a7eb4b8f69a1dfcb646ccb20a72822a74">SOL_LWM2M_RESOURCE_DATA_TYPE_BOOL</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Bootstrap Server] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;sec_server_one[2],</div>
<div class="line">        <a name="a36"></a><a class="code" href="lwm2m-bs-server_8c.html#a175bc002a7daabede0dce459bb6413bf">SECURITY_SECURITY_MODE_RES_ID</a>, <a name="a37"></a><a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4aff444ef6633cc0defa4373b4087f0a55">SOL_LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Security Mode] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;sec_server_one[3], <a name="a38"></a><a class="code" href="lwm2m-bs-server_8c.html#aaa683d911c3b5b10c99dcbb760eab73f">SECURITY_PUBLIC_KEY_OR_IDENTITY_RES_ID</a>,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;psk_id_0);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Public Key or Identity] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga07b5df38b39dd482c07ce6c1a385ba26">SOL_LWM2M_RESOURCE_SINGLE_INIT</a>(r, &amp;sec_server_one[4], <a name="a39"></a><a class="code" href="lwm2m-bs-server_8c.html#a33f5f455b1ccf9ea0c50b91f73f74c68">SECURITY_SECRET_KEY_RES_ID</a>,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#gga12e9bf9b4a884e281cdda5c56f09ca48af2f40e74d2a66002e1227653a6fb0065">SOL_LWM2M_RESOURCE_DATA_TYPE_STRING</a>, &amp;psk_key_0);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Secret Key] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="group__LWM2M.html#ga659350a6a0e95c503af3e61f9056aeb7">SOL_LWM2M_RESOURCE_SINGLE_INT_INIT</a>(r, &amp;sec_server_one[5], <a name="a40"></a><a class="code" href="lwm2m-bs-server_8c.html#a0fcc33add08c439f2ad08db2d77705fe">SECURITY_SERVER_ID_RES_ID</a>, 102);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not init Security Object&#39;s [Short Server ID] resource\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    r = <a class="code" href="group__lwm2m__bs-server.html#ga459e5ddc708f8b1c7780f314cc31ef65">sol_lwm2m_bootstrap_server_write</a>(server, bs_cinfo, <span class="stringliteral">&quot;/0/0&quot;</span>,</div>
<div class="line">        sec_server_one, <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(sec_server_one), <a class="code" href="lwm2m-bs-server_8c.html#aa7de55e6a72b455f4ac4f0f841300fb9">write_sec_one_cb</a>, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Write to /0/0\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__Utils.html#ga8f1ab5ab1508e066a38673a56b8da661">sol_util_array_size</a>(sec_server_one); i++)</div>
<div class="line">        <a class="code" href="group__LWM2M.html#ga1d1f9bfd1cd20bad0958fae7a30b8ca3">sol_lwm2m_resource_clear</a>(&amp;sec_server_one[i]);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="a41"></a><a class="code" href="lwm2m-bs-server_8c.html#aebce2810c9cb2e64fadfe14687d6c60e">bootstrap_cb</a>(<span class="keywordtype">void</span> *data,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *server,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="group__lwm2m__bs-server.html#ga8d3317f2b31c1b56a0d288bdc5fe3f8c">sol_lwm2m_bootstrap_client_info</a> *bs_cinfo)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name = <a class="code" href="group__lwm2m__bs-server.html#ga41bbb0c41854155ebbcc1762863d0189">sol_lwm2m_bootstrap_client_info_get_name</a>(bs_cinfo);</div>
<div class="line">    <span class="keywordtype">int</span> r;</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Client-initiated Bootstrap from %s starting!\n&quot;</span>, name);</div>
<div class="line"></div>
<div class="line">    r = <a name="a42"></a><a class="code" href="group__lwm2m__bs-server.html#gac2974f491c5eefb8588e47e09df615e2">sol_lwm2m_bootstrap_server_delete_object_instance</a>(server, bs_cinfo, <span class="stringliteral">&quot;/&quot;</span>,</div>
<div class="line">        <a class="code" href="lwm2m-bs-server_8c.html#aef4e7c3aca43eeada6f65597335a068e">delete_all_cb</a>, NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not send Bootstrap Delete to /\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line"><a name="a43"></a><a class="code" href="iotivity-test-client_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="group__lwm2m__bs-server.html#gac0d8b21d501a655e955df3df06e5a144">sol_lwm2m_bootstrap_server</a> *<a class="code" href="server-https_8c.html#a3364dabb1b0bcb5ea73872456898225e">server</a>;</div>
<div class="line">    uint16_t <a name="a44"></a><a class="code" href="server-sse_8c.html#a63c89c04d1feae07ca35558055155ffb">port</a> = 5783, i;</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="group__LWM2M.html#gaf6feb041e0d8678907ba6745ad14ecf4">sol_lwm2m_security_mode</a> sec_modes[2] = { };</div>
<div class="line">    <span class="keywordtype">int</span> r, sec_modes_len = 0;</div>
<div class="line">    <span class="keywordtype">char</span> <a name="a45"></a><a class="code" href="iotivity-test-client_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a>[256];</div>
<div class="line">    <span class="keyword">struct </span><a name="_a46"></a><a class="code" href="structsol__lwm2m__security__rpk.html">sol_lwm2m_security_rpk</a> my_rpk;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf_aux[<a name="a47"></a><a class="code" href="lwm2m-bs-server_8c.html#a014080225d5e209d2ed85f24f361e70d">RPK_PUBLIC_KEY_LEN</a>];</div>
<div class="line">    <span class="keyword">struct </span><a name="_a48"></a><a class="code" href="structsol__lwm2m__security__psk.html">sol_lwm2m_security_psk</a> *known_keys[] = {</div>
<div class="line">        &amp;((<span class="keyword">struct </span><a class="code" href="structsol__lwm2m__security__psk.html">sol_lwm2m_security_psk</a>) {</div>
<div class="line">            .id = NULL,</div>
<div class="line">            .key = NULL</div>
<div class="line">        }),</div>
<div class="line">        NULL</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structsol__blob.html">sol_blob</a> *known_pub_keys[] = { NULL, NULL };</div>
<div class="line"></div>
<div class="line">    snprintf(usage, <span class="keyword">sizeof</span>(usage), <span class="stringliteral">&quot;Usage: ./lwm2m-sample-bs-server [-p PORT] -s SEC_MODE...\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Where default PORT=%&quot;</span> PRIu16 <span class="stringliteral">&quot; and SEC_MODE is an integer as per:\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tPRE_SHARED_KEY=%d\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tRAW_PUBLIC_KEY=%d\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\tCERTIFICATE=%d\n\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;For multiple SEC_MODEs, they must be passed in ascending order.\n&quot;</span>,</div>
<div class="line">        port,</div>
<div class="line">        <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4aff444ef6633cc0defa4373b4087f0a55">SOL_LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>,</div>
<div class="line">        <a name="a49"></a><a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4adbcedd7f3813dbeaec7ea16a72803277">SOL_LWM2M_SECURITY_MODE_RAW_PUBLIC_KEY</a>,</div>
<div class="line">        <a name="a50"></a><a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4addadf86e1ed98bf4e7b047dbcc492c04">SOL_LWM2M_SECURITY_MODE_CERTIFICATE</a>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> ((r = getopt(argc, argv, <span class="stringliteral">&quot;p:s:&quot;</span>)) != -1) {</div>
<div class="line">        <span class="keywordflow">switch</span> (r) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line">            port = atoi(optarg);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line">            <span class="keywordflow">if</span> (sec_modes_len &lt; 2) {</div>
<div class="line">                sec_modes[sec_modes_len] = atoi(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (sec_modes[sec_modes_len] &lt; 0 || sec_modes[sec_modes_len] &gt; 2) {</div>
<div class="line">                    fprintf(stderr, <span class="stringliteral">&quot;%s&quot;</span>, usage);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                sec_modes_len++;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;%s&quot;</span>, usage);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;%s&quot;</span>, usage);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Using port %&quot;</span> PRIu16 <span class="stringliteral">&quot; for DTLS\n&quot;</span>, port);</div>
<div class="line">    <a name="a51"></a><a class="code" href="group__Mainloop.html#ga2b7881c0cfcf1516e99a57949987425c">sol_init</a>();</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; sec_modes_len; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (sec_modes[i] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4aff444ef6633cc0defa4373b4087f0a55">SOL_LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>) {</div>
<div class="line">            known_keys[0]-&gt;<a name="a52"></a><a class="code" href="structsol__lwm2m__security__psk.html#a104184a40f73533d87825d886f9eee8c">id</a> = <a name="a53"></a><a class="code" href="group__Types.html#ga470d1640c88fc8739174ad9eb9fa190d">sol_blob_new_dup</a>(<a name="a54"></a><a class="code" href="lwm2m-bs-server_8c.html#af73e9a9828f1305cab77969ead42d8c3">CLIENT_BS_PSK_ID</a>, <span class="keyword">sizeof</span>(<a class="code" href="lwm2m-bs-server_8c.html#af73e9a9828f1305cab77969ead42d8c3">CLIENT_BS_PSK_ID</a>) - 1);</div>
<div class="line">            known_keys[0]-&gt;<a name="a55"></a><a class="code" href="structsol__lwm2m__security__psk.html#ab762e0903d4486e7cfd73412e1af6148">key</a> = <a class="code" href="group__Types.html#ga470d1640c88fc8739174ad9eb9fa190d">sol_blob_new_dup</a>(<a name="a56"></a><a class="code" href="lwm2m-bs-server_8c.html#a6061860b8f43a219ac8c81d2753e9d8f">CLIENT_BS_PSK_KEY</a>, <a name="a57"></a><a class="code" href="lwm2m-bs-server_8c.html#a5689733a7085ecd9ffac1934d72925ad">PSK_KEY_LEN</a>);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec_modes[i] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4adbcedd7f3813dbeaec7ea16a72803277">SOL_LWM2M_SECURITY_MODE_RAW_PUBLIC_KEY</a>) {</div>
<div class="line">            r = <a name="a58"></a><a class="code" href="group__Utils.html#gac4089d5876b27d70240b2ad07d4b6f64">sol_util_base16_decode</a>(buf_aux, <span class="keyword">sizeof</span>(buf_aux),</div>
<div class="line">                <a name="a59"></a><a class="code" href="group__Str__Slice.html#ga403d23f24219db595e892573d3384c37">sol_str_slice_from_str</a>(<a name="a60"></a><a class="code" href="lwm2m-bs-server_8c.html#a37b3dcc0c83768bdef33bf258cf13161">CLIENT_PUBLIC_KEY</a>), <a name="a61"></a><a class="code" href="group__Buffer.html#gga06c94d5ad12e5abae2f881a53c6becf8a5dbb2176517c701da97d610b6460bfbd">SOL_DECODE_BOTH</a>);</div>
<div class="line">            known_pub_keys[0] = <a class="code" href="group__Types.html#ga470d1640c88fc8739174ad9eb9fa190d">sol_blob_new_dup</a>(buf_aux, <a class="code" href="lwm2m-bs-server_8c.html#a014080225d5e209d2ed85f24f361e70d">RPK_PUBLIC_KEY_LEN</a>);</div>
<div class="line"></div>
<div class="line">            r = <a class="code" href="group__Utils.html#gac4089d5876b27d70240b2ad07d4b6f64">sol_util_base16_decode</a>(buf_aux, <span class="keyword">sizeof</span>(buf_aux),</div>
<div class="line">                <a class="code" href="group__Str__Slice.html#ga403d23f24219db595e892573d3384c37">sol_str_slice_from_str</a>(<a name="a62"></a><a class="code" href="lwm2m-bs-server_8c.html#a69491fe240ca95831fc0835a7557a03f">BS_SERVER_PRIVATE_KEY</a>), <a class="code" href="group__Buffer.html#gga06c94d5ad12e5abae2f881a53c6becf8a5dbb2176517c701da97d610b6460bfbd">SOL_DECODE_BOTH</a>);</div>
<div class="line">            my_rpk.private_key = <a class="code" href="group__Types.html#ga470d1640c88fc8739174ad9eb9fa190d">sol_blob_new_dup</a>(buf_aux, <a name="a63"></a><a class="code" href="lwm2m-bs-server_8c.html#a11fa11b249db08ae69bb056a48f7ca95">RPK_PRIVATE_KEY_LEN</a>);</div>
<div class="line">            r = <a class="code" href="group__Utils.html#gac4089d5876b27d70240b2ad07d4b6f64">sol_util_base16_decode</a>(buf_aux, <span class="keyword">sizeof</span>(buf_aux),</div>
<div class="line">                <a class="code" href="group__Str__Slice.html#ga403d23f24219db595e892573d3384c37">sol_str_slice_from_str</a>(<a name="a64"></a><a class="code" href="lwm2m-bs-server_8c.html#acc5496672f9ffe632c063e73cda42e43">BS_SERVER_PUBLIC_KEY</a>), <a class="code" href="group__Buffer.html#gga06c94d5ad12e5abae2f881a53c6becf8a5dbb2176517c701da97d610b6460bfbd">SOL_DECODE_BOTH</a>);</div>
<div class="line">            my_rpk.public_key = <a class="code" href="group__Types.html#ga470d1640c88fc8739174ad9eb9fa190d">sol_blob_new_dup</a>(buf_aux, <a class="code" href="lwm2m-bs-server_8c.html#a014080225d5e209d2ed85f24f361e70d">RPK_PUBLIC_KEY_LEN</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (sec_modes_len == 1) {</div>
<div class="line">        <span class="keywordflow">if</span> (sec_modes[0] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4aff444ef6633cc0defa4373b4087f0a55">SOL_LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>)</div>
<div class="line">            server = <a name="a65"></a><a class="code" href="group__lwm2m__bs-server.html#gaf5861b1bd461006c043bd74108b81884">sol_lwm2m_bootstrap_server_new</a>(port, <a class="code" href="lwm2m-bs-server_8c.html#a4f866fa0389efe4c44b93653d7d1a9d9">known_clients</a>,</div>
<div class="line">                sec_modes_len, sec_modes[0], known_keys);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec_modes[0] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4adbcedd7f3813dbeaec7ea16a72803277">SOL_LWM2M_SECURITY_MODE_RAW_PUBLIC_KEY</a>)</div>
<div class="line">            server = <a class="code" href="group__lwm2m__bs-server.html#gaf5861b1bd461006c043bd74108b81884">sol_lwm2m_bootstrap_server_new</a>(port, <a class="code" href="lwm2m-bs-server_8c.html#a4f866fa0389efe4c44b93653d7d1a9d9">known_clients</a>,</div>
<div class="line">                sec_modes_len, sec_modes[0], &amp;my_rpk, known_pub_keys);</div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;%s&quot;</span>, usage);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec_modes_len == 2) {</div>
<div class="line">        server = <a class="code" href="group__lwm2m__bs-server.html#gaf5861b1bd461006c043bd74108b81884">sol_lwm2m_bootstrap_server_new</a>(port, <a class="code" href="lwm2m-bs-server_8c.html#a4f866fa0389efe4c44b93653d7d1a9d9">known_clients</a>,</div>
<div class="line">            sec_modes_len, sec_modes[0], known_keys,</div>
<div class="line">            sec_modes[1], &amp;my_rpk, known_pub_keys);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;%s&quot;</span>, usage);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!server) {</div>
<div class="line">        r = -1;</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not create the LWM2M bootstrap server\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> exit;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    r = <a name="a66"></a><a class="code" href="group__lwm2m__bs-server.html#ga2efd3117c4dce2cc876742a6f0dbf5c2">sol_lwm2m_bootstrap_server_add_request_monitor</a>(server, <a class="code" href="lwm2m-bs-server_8c.html#aebce2810c9cb2e64fadfe14687d6c60e">bootstrap_cb</a>,</div>
<div class="line">        NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Could not add a bootstrap monitor\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> exit_del;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a67"></a><a class="code" href="group__Mainloop.html#ga40ef0e2ee61ea7a548c00bbae980408b">sol_run</a>();</div>
<div class="line"></div>
<div class="line">    r = 0;</div>
<div class="line">exit_del:</div>
<div class="line">    <a name="a68"></a><a class="code" href="group__lwm2m__bs-server.html#ga676c66b99ad465db140811a049b96fd7">sol_lwm2m_bootstrap_server_del</a>(server);</div>
<div class="line">exit:</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; sec_modes_len; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (sec_modes[i] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4aff444ef6633cc0defa4373b4087f0a55">SOL_LWM2M_SECURITY_MODE_PRE_SHARED_KEY</a>) {</div>
<div class="line">            <a name="a69"></a><a class="code" href="group__Types.html#gaaf14a0023ae6a06a7e9960e5b622a2ad">sol_blob_unref</a>(known_keys[0]-&gt;<span class="keywordtype">id</span>);</div>
<div class="line">            <a class="code" href="group__Types.html#gaaf14a0023ae6a06a7e9960e5b622a2ad">sol_blob_unref</a>(known_keys[0]-&gt;<a name="a70"></a><a class="code" href="server-https_8c.html#ab33f20cf0cb32c6c72a285f53aead32b">key</a>);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sec_modes[i] == <a class="code" href="group__LWM2M.html#ggaf6feb041e0d8678907ba6745ad14ecf4adbcedd7f3813dbeaec7ea16a72803277">SOL_LWM2M_SECURITY_MODE_RAW_PUBLIC_KEY</a>) {</div>
<div class="line">            <a class="code" href="group__Types.html#gaaf14a0023ae6a06a7e9960e5b622a2ad">sol_blob_unref</a>(known_pub_keys[0]);</div>
<div class="line">            <a class="code" href="group__Types.html#gaaf14a0023ae6a06a7e9960e5b622a2ad">sol_blob_unref</a>(my_rpk.private_key);</div>
<div class="line">            <a class="code" href="group__Types.html#gaaf14a0023ae6a06a7e9960e5b622a2ad">sol_blob_unref</a>(my_rpk.public_key);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <a name="a71"></a><a class="code" href="group__Mainloop.html#gaf9fa52b0c849ded3ede3823eb1a90f76">sol_shutdown</a>();</div>
<div class="line">    <span class="keywordflow">return</span> r;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
<a href="index.html">C API Index</a>
</small></address>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
