<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Soletta™ Framework: Reentrant</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Soletta™ Framework
   </div>
   <div id="projectbrief">
   Framework for making IoT devices<br /><br />
   <small>
   <a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
   <a href="index.html">C API Index</a>
   </small><br />
   </div>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">Reentrant</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsol__reentrant.html">sol_reentrant</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing the flags for safely freeing a larger structure.  <a href="structsol__reentrant.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga9ea2042382ce22b3f8bc086bc211e792"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Reentrant.html#ga9ea2042382ce22b3f8bc086bc211e792">SOL_REENTRANT_CALL</a>(handle)</td></tr>
<tr class="memdesc:ga9ea2042382ce22b3f8bc086bc211e792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wraps a function call to an external callback.  <a href="#ga9ea2042382ce22b3f8bc086bc211e792">More...</a><br/></td></tr>
<tr class="separator:ga9ea2042382ce22b3f8bc086bc211e792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6b0fac049a35897fc6d6551fb72e3eb7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Reentrant.html#ga6b0fac049a35897fc6d6551fb72e3eb7">SOL_REENTRANT_FREE</a>(reentrant)&#160;&#160;&#160;if (({ (reentrant).delete_me = true; !(reentrant).in_use; }))</td></tr>
<tr class="memdesc:ga6b0fac049a35897fc6d6551fb72e3eb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conditionally free a reentrant structure.  <a href="#ga6b0fac049a35897fc6d6551fb72e3eb7">More...</a><br/></td></tr>
<tr class="separator:ga6b0fac049a35897fc6d6551fb72e3eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaf5577e44b506b7e37c24b38e5fc13941"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsol__reentrant.html">sol_reentrant</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Reentrant.html#gaf5577e44b506b7e37c24b38e5fc13941">sol_reentrant</a></td></tr>
<tr class="memdesc:gaf5577e44b506b7e37c24b38e5fc13941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing the flags for safely freeing a larger structure.  <a href="#gaf5577e44b506b7e37c24b38e5fc13941">More...</a><br/></td></tr>
<tr class="separator:gaf5577e44b506b7e37c24b38e5fc13941"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga9ea2042382ce22b3f8bc086bc211e792"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOL_REENTRANT_CALL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">handle</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">bool</span> reentrant_run = <span class="keyword">true</span>; reentrant_run; reentrant_run = <span class="keyword">false</span>) \</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">bool</span> reentrant_was_used = (handle).in_use; reentrant_run; \</div>
<div class="line">            (handle).in_use = reentrant_was_used, reentrant_run = <span class="keyword">false</span>) \</div>
<div class="line">            for ((handle).in_use = <span class="keyword">true</span>; reentrant_run; reentrant_run = <span class="keyword">false</span>)</div>
</div><!-- fragment -->
<p>Wraps a function call to an external callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>The reentrant tracking the structure affected by the function call</td></tr>
  </table>
  </dd>
</dl>
<p>Wraps the statement or statement block following it by marking the handle passed in as the parameter as being in use. Thus, if you call an external callback from within the block which attempts to free the structure, the structure will be protected from deletion by the flags set in the preamble. For example:</p>
<div class="fragment"><div class="line">SO_REENTRANT_CALL(context-&gt;reentrant) {</div>
<div class="line">    context-&gt;cb(context-&gt;data);</div>
<div class="line">    context-&gt;cb_was_called = <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>will ensure that the context will not be freed as part of the call to <code>context-&gt;cb()</code> and will be available after <code>context-&gt;cb()</code> returns as long as all calls to free the context are made via <a class="el" href="group__Reentrant.html#ga6b0fac049a35897fc6d6551fb72e3eb7" title="Conditionally free a reentrant structure. ">SOL_REENTRANT_FREE()</a>. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="src_2samples_2design_patterns_2stream_sample_8c-example.html#a49">/src/samples/design_patterns/stream_sample.c</a>.</dd>
</dl>
<p>Referenced by <a class="el" href="stream__sample_8c.html#a2f9f4d9b9c23b6a058b614a3f8a18dd9">_inform_user()</a>.</p>

</div>
</div>
<a class="anchor" id="ga6b0fac049a35897fc6d6551fb72e3eb7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOL_REENTRANT_FREE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">reentrant</td><td>)</td>
          <td>&#160;&#160;&#160;if (({ (reentrant).delete_me = true; !(reentrant).in_use; }))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conditionally free a reentrant structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reentrant</td><td>The reentrant to free</td></tr>
  </table>
  </dd>
</dl>
<p>Provides a condition statement for calling the function that frees the structure associated with the reentrant passed in as the parameter. As a side effect it also marks the structure as needing deletion. </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="src_2samples_2design_patterns_2stream_sample_8c-example.html#a52">/src/samples/design_patterns/stream_sample.c</a>.</dd>
</dl>
<p>Referenced by <a class="el" href="stream__sample_8c.html#a2f9f4d9b9c23b6a058b614a3f8a18dd9">_inform_user()</a>, and <a class="el" href="stream__sample_8c.html#a86de373ce01d0d7b8bee9b849e80881b">my_stream_api_close()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaf5577e44b506b7e37c24b38e5fc13941"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsol__reentrant.html">sol_reentrant</a>  <a class="el" href="structsol__reentrant.html">sol_reentrant</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Structure containing the flags for safely freeing a larger structure. </p>
<p>This structure is meant to be used inside larger structures which are affected by calls to external callbacks that in turn end up calling library APIs. The possibility of a double free is particularly likely in such cases. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
<a href="index.html">C API Index</a>
</small></address>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
