<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Soletta™ Framework: Update</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Soletta™ Framework
   </div>
   <div id="projectbrief">
   Framework for making IoT devices<br /><br />
   <small>
   <a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
   <a href="index.html">C API Index</a>
   </small><br />
   </div>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Update</div>  </div>
</div><!--header-->
<div class="contents">

<p>Updating a Soletta based app may vary depending on Soletta environment and configuration.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__UpdateModules"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__UpdateModules.html">Update modules</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsol__update__info.html">sol_update_info</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains update info got via <code>sol_update_check</code> call.  <a href="structsol__update__info.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga13346c03bab68461572b199c643e080d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a></td></tr>
<tr class="memdesc:ga13346c03bab68461572b199c643e080d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle returned by some sol_update* calls, so they can be cancelled appropriately.  <a href="#ga13346c03bab68461572b199c643e080d">More...</a><br/></td></tr>
<tr class="separator:ga13346c03bab68461572b199c643e080d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa0e860e310d678ba7063995bc7b76ffe"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsol__update__info.html">sol_update_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#gaa0e860e310d678ba7063995bc7b76ffe">sol_update_info</a></td></tr>
<tr class="memdesc:gaa0e860e310d678ba7063995bc7b76ffe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains update info got via <code>sol_update_check</code> call.  <a href="#gaa0e860e310d678ba7063995bc7b76ffe">More...</a><br/></td></tr>
<tr class="separator:gaa0e860e310d678ba7063995bc7b76ffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae2298478c57eaa83a8b60726aa518652"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#gae2298478c57eaa83a8b60726aa518652">sol_update_cancel</a> (struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *handle)</td></tr>
<tr class="memdesc:gae2298478c57eaa83a8b60726aa518652"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel an ongoing check, fetch or install task.  <a href="#gae2298478c57eaa83a8b60726aa518652">More...</a><br/></td></tr>
<tr class="separator:gae2298478c57eaa83a8b60726aa518652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05ebfa49399ff48612a10563074d637f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#ga05ebfa49399ff48612a10563074d637f">sol_update_check</a> (void(*cb)(void *data, int status, const struct <a class="el" href="structsol__update__info.html">sol_update_info</a> *response), const void *data)</td></tr>
<tr class="memdesc:ga05ebfa49399ff48612a10563074d637f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if there's an update to get.  <a href="#ga05ebfa49399ff48612a10563074d637f">More...</a><br/></td></tr>
<tr class="separator:ga05ebfa49399ff48612a10563074d637f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga98f7a217544549936190d8e59492b63e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#ga98f7a217544549936190d8e59492b63e">sol_update_fetch</a> (void(*cb)(void *data, int status), const void *data, bool resume)</td></tr>
<tr class="memdesc:ga98f7a217544549936190d8e59492b63e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch update, so it can be installed later wit <code>sol_update_install</code>.  <a href="#ga98f7a217544549936190d8e59492b63e">More...</a><br/></td></tr>
<tr class="separator:ga98f7a217544549936190d8e59492b63e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa9ff981aa67736feca1f1b6647da2489"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#gaa9ff981aa67736feca1f1b6647da2489">sol_update_get_progress</a> (struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *handle)</td></tr>
<tr class="memdesc:gaa9ff981aa67736feca1f1b6647da2489"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get progress of given update task.  <a href="#gaa9ff981aa67736feca1f1b6647da2489">More...</a><br/></td></tr>
<tr class="separator:gaa9ff981aa67736feca1f1b6647da2489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Update.html#ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94">sol_update_install</a> (void(*cb)(void *data, int status), const void *data)</td></tr>
<tr class="memdesc:ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Install update.  <a href="#ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94">More...</a><br/></td></tr>
<tr class="separator:ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Updating a Soletta based app may vary depending on Soletta environment and configuration. </p>
<p>For instance, updating a static Linux Micro (PID 1) Soletta based app is only a matter of replacing app file, but when using shared libs, may involve update/install newer versions of used libs. So, Soletta provides different update modules to update Soletta based apps on different scenarios. Soletta will try to use the first module it can use, but if having different modules to be loaded, environment variable SOL_UPDATE_MODULE can be used to define a specific one, like SOL_UPDATE_MODULE=linux-micro-efi-update.</p>
<p>When Soletta update module cheks for update, it should get version and size of new file to fill <code><a class="el" href="structsol__update__info.html" title="Contains update info got via sol_update_check call. ">sol_update_info</a></code>.</p>
<p>Each update module is free to decide how to check, fetch and install the update. Check update module documentation to understand how it works. Note also that comparing obtained version with app current version and deciding to fetch update file is up to user/developer. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga13346c03bab68461572b199c643e080d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle returned by some sol_update* calls, so they can be cancelled appropriately. </p>

</div>
</div>
<a class="anchor" id="gaa0e860e310d678ba7063995bc7b76ffe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsol__update__info.html">sol_update_info</a>  <a class="el" href="structsol__update__info.html">sol_update_info</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contains update info got via <code>sol_update_check</code> call. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__Update.html#ga05ebfa49399ff48612a10563074d637f" title="Check if there&#39;s an update to get. ">sol_update_check</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gae2298478c57eaa83a8b60726aa518652"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sol_update_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel an ongoing check, fetch or install task. </p>
<p>Note that cancelling the task may not be possible at any moment, depending on update module being used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>handle of update task to be cancelled.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if current task was successfully cancelled.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If cancel was successful, then <em>handle</em> becomes invalid. If not, task callback shall still be called. </dd></dl>

</div>
</div>
<a class="anchor" id="ga05ebfa49399ff48612a10563074d637f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a>* sol_update_check </td>
          <td>(</td>
          <td class="paramtype">void(*)(void *data, int status, const struct <a class="el" href="structsol__update__info.html">sol_update_info</a> *response)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if there's an update to get. </p>
<p>Module must return a <code><a class="el" href="structsol__update__info.html" title="Contains update info got via sol_update_check call. ">sol_update_info</a></code> containing update size and version.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback that will be called to return update information. If status &lt; 0, then something went wrong with check and <code>response</code> is undefined. If status == 0, check went OK and <code>response</code> argument shall contain obtained update information. </td></tr>
    <tr><td class="paramname">data</td><td>user defined data to be sent to callback <em>cb</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle of this update task, or NULL if couldn't start the task. Note that handle will be invalid after <em>cb</em> is called, or if it was cancelled.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__Update.html#gae2298478c57eaa83a8b60726aa518652" title="Cancel an ongoing check, fetch or install task. ">sol_update_cancel</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga98f7a217544549936190d8e59492b63e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a>* sol_update_fetch </td>
          <td>(</td>
          <td class="paramtype">void(*)(void *data, int status)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>resume</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fetch update, so it can be installed later wit <code>sol_update_install</code>. </p>
<p>Fetch will get the update. Update module should check its hash and signature before informing that task was completed successfully. If everything is OK, callback <em>cb</em> will be called with status == 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback called to inform fetch completion or failure. If status &lt; 0, then something went wrong. If status == 0, fetch went OK and <code>sol_update_install</code> can be used to install the update.</td></tr>
    <tr><td class="paramname">data</td><td>user specified data to be sent to callback <em>cb</em> </td></tr>
    <tr><td class="paramname">resume</td><td>NOT IMPLEMENTED. If false, any previous data downloaded shall be discarded. Otherwise, will resume a previous cancelled fetch.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle of this update task, or NULL if couldn't start the task. Note that handle will be invalid after <em>cb</em> is called, or if it was cancelled.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__Update.html#gae2298478c57eaa83a8b60726aa518652" title="Cancel an ongoing check, fetch or install task. ">sol_update_cancel</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gaa9ff981aa67736feca1f1b6647da2489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sol_update_get_progress </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get progress of given update task. </p>
<p>Note that getting the progress may not work for all tasks, depending on update module being used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>handle of update task to get current progress.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>current progress of task between 0 and 100, or -1 if couldn't get progress. </dd></dl>

</div>
</div>
<a class="anchor" id="ga6f9e5cb3cac2aa1a6ca7a6a5e3bc1f94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="group__Update.html#ga13346c03bab68461572b199c643e080d">sol_update_handle</a>* sol_update_install </td>
          <td>(</td>
          <td class="paramtype">void(*)(void *data, int status)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Install update. </p>
<p>Install process vary depending on update module being used, but all shall give feedback of success or not on <em>cb</em> callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cb</td><td>callback called to inform installation success or failure. If status &lt; 0, then something went wrong. If status == 0, installation completed successfully. </td></tr>
    <tr><td class="paramname">data</td><td>user defined data to be passed to callback <em>cb</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>handle of this update task, or NULL if couldn't start the task. Note that handle will be invalid after <em>cb</em> is called, or if it was cancelled.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__Update.html#gae2298478c57eaa83a8b60726aa518652" title="Cancel an ongoing check, fetch or install task. ">sol_update_cancel</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<a href="http://solettaproject.github.io/docs/">Full online documentation</a> | 
<a href="index.html">C API Index</a>
</small></address>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
